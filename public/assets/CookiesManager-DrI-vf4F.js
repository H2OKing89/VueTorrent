import{y as E,c as _,d as F,p as O,a7 as P,ag as J,z as I,A as T,B as t,C as e,E as M,F as b,u as r,aj as N,i as q,D as ne,R as ie,N as se,x as re,_ as ue,I as de,H as B}from"./vue-BoVUvQ2U.js";import{a as z,u as H,E as U,a0 as ce}from"./composables-BW22VNGX.js";import{i as A,u as me,a as pe}from"./stores-wQBBgkg3.js";import{V as R,a as K,B as W,C as G,e as m,b as Q,k as fe,n as Y,m as v,i as S,N as X,c as Z,f as ee,p as ge,J as ke,h as ve,K as Ve,o as L,d as De,r as xe,L as Ce,y as ye}from"./vuetify-B4AYIWqO.js";const be=E({__name:"CookieFormDialog",props:{guid:{},initialCookie:{}},setup($){const D=$,{isOpened:V}=z(D.guid),{t:i}=H(),p=A(),x=_(()=>!!D.initialCookie),f=[()=>{const u=p.cookies.filter(n=>n.equals(l));return!x.value&&u.length!==0||x.value&&u.length>0&&!D.initialCookie.equals(l)?i("dialogs.cookiesManager.rules.duplicate"):!0}],g=F(!1),l=O(new U({name:"",value:"",domain:"",path:"",expirationDate:0})),y=_({get:()=>new Date(l.expirationDate*1e3).toDateString(),set:u=>{const n=new Date(l.expirationDate*1e3),k=new Date(u);n.setFullYear(k.getFullYear()),n.setMonth(k.getMonth()),n.setDate(k.getDate()),l.expirationDate=n.getTime()/1e3}}),C=_({get:()=>{const u=new Date(l.expirationDate*1e3);return`${u.getHours()}:${u.getMinutes()}:${u.getSeconds()}`},set:u=>{const n=new Date(l.expirationDate*1e3),[k,s,a]=u.split(":");n.setHours(+k),n.setMinutes(+s),n.setSeconds(+a),l.expirationDate=n.getTime()/1e3}});async function h(){g.value&&(x.value&&await p.removeCookie(D.initialCookie),await p.addCookie(l,!0),w())}const w=()=>{V.value=!1};return P(()=>{if(x.value)Object.assign(l,D.initialCookie);else{const u=new Date;u.setMilliseconds(0),u.setFullYear(new Date().getFullYear()+1),l.expirationDate=u.getTime()/1e3}}),(u,n)=>{const k=J("v-time-picker");return T(),I(ee,{modelValue:r(V),"onUpdate:modelValue":n[8]||(n[8]=s=>q(V)?V.value=s:null),"max-width":"1250"},{default:t(()=>[e(R,null,{default:t(()=>[e(K,{class:"ios-margin"},{default:t(()=>[e(W,{color:"transparent"},{default:t(()=>[e(G,null,{default:t(()=>[M(b(r(i)("dialogs.cookiesManager.title")),1)]),_:1}),e(m,{icon:"mdi-close",onClick:w})]),_:1})]),_:1}),e(Q,null,{default:t(()=>[e(fe,{modelValue:g.value,"onUpdate:modelValue":n[6]||(n[6]=s=>g.value=s),onSubmit:n[7]||(n[7]=N(()=>{},["prevent"]))},{default:t(()=>[e(Y,null,{default:t(()=>[e(v,{cols:"12",sm:"6"},{default:t(()=>[e(S,{modelValue:l.domain,"onUpdate:modelValue":n[0]||(n[0]=s=>l.domain=s),label:r(i)("dialogs.cookiesManager.domain")},null,8,["modelValue","label"])]),_:1}),e(v,{cols:"12",sm:"6"},{default:t(()=>[e(S,{modelValue:l.path,"onUpdate:modelValue":n[1]||(n[1]=s=>l.path=s),label:r(i)("dialogs.cookiesManager.path")},null,8,["modelValue","label"])]),_:1}),e(v,{cols:"12",sm:"6"},{default:t(()=>[e(S,{modelValue:l.name,"onUpdate:modelValue":n[2]||(n[2]=s=>l.name=s),label:r(i)("dialogs.cookiesManager.name"),rules:f},null,8,["modelValue","label"])]),_:1}),e(v,{cols:"12",sm:"6"},{default:t(()=>[e(S,{modelValue:l.value,"onUpdate:modelValue":n[3]||(n[3]=s=>l.value=s),label:r(i)("dialogs.cookiesManager.value")},null,8,["modelValue","label"])]),_:1}),e(v,{cols:"12",sm:"6",class:"d-flex justify-center"},{default:t(()=>[e(X,{modelValue:y.value,"onUpdate:modelValue":n[4]||(n[4]=s=>y.value=s),min:new Date},null,8,["modelValue","min"])]),_:1}),e(v,{cols:"12",sm:"6",class:"d-flex justify-center"},{default:t(()=>[e(k,{modelValue:C.value,"onUpdate:modelValue":n[5]||(n[5]=s=>C.value=s),format:"24hr","use-seconds":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(Z,null,{default:t(()=>[e(m,{disabled:!g.value,color:"accent",onClick:h},{default:t(()=>[M(b(r(i)("common.submit")),1)]),_:1},8,["disabled"]),e(m,{color:"error",onClick:w},{default:t(()=>[M(b(r(i)("common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),we=E({__name:"CookieImportDialog",props:{guid:{}},setup($){const D=$,{isOpened:V}=z(D.guid),{t:i}=H(),p=A(),x=[{title:i("dialogs.cookiesImport.type.netscape"),value:0,props:{prependIcon:"mdi-table"}},{title:i("dialogs.cookiesImport.type.json"),value:1,props:{prependIcon:"mdi-code-json"}},{title:i("dialogs.cookiesImport.type.header"),value:2,props:{prependIcon:"mdi-text-long"}}],f=F(0),g=F(""),l=O({domain:"",path:"",expirationDate:0}),y=F(!1),C=_({get:()=>new Date(l.expirationDate*1e3).toDateString(),set:a=>{const o=new Date(l.expirationDate*1e3),c=new Date(a);o.setFullYear(c.getFullYear()),o.setMonth(c.getMonth()),o.setDate(c.getDate()),l.expirationDate=o.getTime()/1e3}}),h=_({get:()=>{const a=new Date(l.expirationDate*1e3);return`${a.getHours()}:${a.getMinutes()}:${a.getSeconds()}`},set:a=>{const o=new Date(l.expirationDate*1e3),[c,d,j]=a.split(":");o.setHours(+c),o.setMinutes(+d),o.setSeconds(+j),l.expirationDate=o.getTime()/1e3}});function w(){const a=JSON.parse(g.value);return Array.isArray(a)?a.map(o=>new U(o)):[new U(a)]}function u(){const a=[],o=g.value.split(`
`);for(const c of o){if(!c||c.startsWith("#"))continue;const d=c.split("	");if(d.length!==7)continue;const[j,,te,,oe,ae,le]=d;a.push(new U({domain:j.trim(),path:te.trim(),name:ae.trim(),value:decodeURIComponent(le.trim()),expirationDate:parseInt(oe.trim(),10)}))}return a}function n(){return g.value.split(";").map(a=>{const[o,c]=a.split("=");return new U({domain:l.domain,path:l.path,name:o.trim(),value:c.trim(),expirationDate:l.expirationDate})})}async function k(){y.value=!0;try{let a;switch(f.value){case 1:a=w();break;case 0:a=u();break;case 2:a=n();break}await p.importCookies(a,!0)}catch(a){ie.error(a),y.value=!1}y.value&&s()}const s=()=>{V.value=!1};return(a,o)=>{const c=J("v-time-picker");return T(),I(ee,{modelValue:r(V),"onUpdate:modelValue":o[6]||(o[6]=d=>q(V)?V.value=d:null),"max-width":"1250"},{default:t(()=>[e(R,null,{default:t(()=>[e(K,{class:"ios-margin"},{default:t(()=>[e(W,{color:"transparent"},{default:t(()=>[e(G,null,{default:t(()=>[M(b(r(i)("dialogs.cookiesImport.title")),1)]),_:1}),e(m,{icon:"mdi-close",onClick:s})]),_:1})]),_:1}),e(Q,null,{default:t(()=>[e(ge,{modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=d=>f.value=d),items:x,label:r(i)("dialogs.cookiesImport.type.label")},null,8,["modelValue","label"]),e(ke,{modelValue:g.value,"onUpdate:modelValue":o[1]||(o[1]=d=>g.value=d),label:r(i)("dialogs.cookiesImport.input")},null,8,["modelValue","label"]),f.value===2?(T(),I(Y,{key:0},{default:t(()=>[e(v,{cols:"12",sm:"6"},{default:t(()=>[e(S,{modelValue:l.domain,"onUpdate:modelValue":o[2]||(o[2]=d=>l.domain=d),label:r(i)("dialogs.cookiesManager.domain")},null,8,["modelValue","label"])]),_:1}),e(v,{cols:"12",sm:"6"},{default:t(()=>[e(S,{modelValue:l.path,"onUpdate:modelValue":o[3]||(o[3]=d=>l.path=d),label:r(i)("dialogs.cookiesManager.path")},null,8,["modelValue","label"])]),_:1}),e(v,{cols:"12",sm:"6",class:"d-flex justify-center"},{default:t(()=>[e(X,{modelValue:C.value,"onUpdate:modelValue":o[4]||(o[4]=d=>C.value=d),min:new Date},null,8,["modelValue","min"])]),_:1}),e(v,{cols:"12",sm:"6",class:"d-flex justify-center"},{default:t(()=>[e(c,{modelValue:h.value,"onUpdate:modelValue":o[5]||(o[5]=d=>h.value=d),format:"24hr","use-seconds":""},null,8,["modelValue"])]),_:1})]),_:1})):ne("",!0)]),_:1}),e(Z,null,{default:t(()=>[e(m,{color:"accent",onClick:k},{default:t(()=>[M(b(r(i)("common.submit")),1)]),_:1}),e(m,{color:"error",onClick:s},{default:t(()=>[M(b(r(i)("common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),_e={class:"pa-3"},Me={style:{"font-size":"1.6em !important"},class:"subtitle-1 ml-2"},he={class:"d-flex justify-end"},Se={class:"d-flex align-center flex-gap"},Fe=E({__name:"CookiesManager",setup($){const{height:D}=ve(),V=se(),{t:i}=H(),p=A(),{cookies:x}=re(p),f=me(),g=pe(),l=_(()=>D.value-64-12*2-48),y=_(()=>[{title:i("cookiesManager.table.domain"),key:"domain"},{title:i("cookiesManager.table.path"),key:"path"},{title:i("cookiesManager.table.name"),key:"name"},{title:i("cookiesManager.table.value"),key:"value",cellProps:{class:"wrap-anywhere"}},{title:i("cookiesManager.table.expiration_date"),key:"expirationDate"},{key:"actions",sortable:!1,nowrap:!0}]);function C(s){f.createDialog(be,{initialCookie:s},p.cookiesFetchTask.perform)}function h(){f.createDialog(we,{},p.cookiesFetchTask.perform)}function w(s){f.confirmAction({title:i("dialogs.confirm.deleteCookie"),text:`Domain: ${s.domain}
Path: ${s.path}
Name: ${s.name}`,yesColor:"error",onConfirm:async()=>{await p.removeCookie(s,!0)}})}function u(){f.confirmAction({title:i("dialogs.confirm.clearCookies"),yesColor:"error",onConfirm:async()=>{await p.clearCookies(!0)}})}const n=()=>{V.push({name:"dashboard"})};function k(s){if(f.hasActiveDialog)return!1;s.key==="Escape"&&(s.preventDefault(),n())}return P(async()=>{document.addEventListener("keydown",k),p.cookiesFetchTask.perform()}),ue(()=>{document.removeEventListener("keydown",k)}),(s,a)=>(T(),de("div",_e,[e(Y,{"no-gutters":"",align:"center",justify:"center"},{default:t(()=>[e(v,null,{default:t(()=>[B("h1",Me,b(r(i)("cookiesManager.title")),1)]),_:1}),e(v,null,{default:t(()=>[B("div",he,[e(m,{icon:"mdi-close",variant:"plain",onClick:n})])]),_:1})]),_:1}),r(x).length?(T(),I(ye,{key:1},{default:t(()=>[e(L,null,{default:t(()=>[B("div",Se,[e(De),e(m,{color:"accent","prepend-icon":"mdi-plus",text:r(i)("cookiesManager.create"),onClick:a[1]||(a[1]=o=>C())},null,8,["text"]),e(m,{color:"accent","prepend-icon":"mdi-import",text:r(i)("cookiesManager.import"),onClick:a[2]||(a[2]=o=>h())},null,8,["text"]),e(m,{color:"error","prepend-icon":"mdi-delete",text:r(i)("cookiesManager.clear"),onClick:a[3]||(a[3]=o=>u())},null,8,["text"])])]),_:1}),e(xe,{class:"my-3"}),e(L,{class:"text-select"},{default:t(()=>[e(Ce,{"header-props":{class:"text-no-wrap"},mobile:null,headers:y.value,items:r(x),"multi-sort":"","footer-props":{itemsPerPageOptions:[10,25,50,100,-1]}},{"item.expirationDate":t(({value:o})=>[M(b(r(ce)(o,r(g).dateFormat)),1)]),"item.actions":t(({item:o})=>[e(m,{icon:"mdi-pencil",variant:"text",density:"compact",onClick:N(c=>C(o),["stop"])},null,8,["onClick"]),e(m,{color:"red",icon:"mdi-delete",variant:"text",density:"compact",onClick:N(c=>w(o),["stop"])},null,8,["onClick"])]),_:2},1032,["headers","items"])]),_:1})]),_:1})):(T(),I(R,{key:0,height:l.value},{default:t(()=>[e(Ve,{title:r(i)("cookiesManager.empty.value"),color:"accent",icon:"mdi-cookie-off"},{actions:t(()=>[e(m,{text:r(i)("cookiesManager.empty.action"),color:"accent",onClick:a[0]||(a[0]=o=>C())},null,8,["text"])]),_:1},8,["title"])]),_:1},8,["height"]))]))}});export{Fe as default};
