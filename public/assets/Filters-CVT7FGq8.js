import{f as M,a5 as K,a6 as w,e as I,J as S,K as u,M as o,n as c,S as Z,Q as L,a7 as Ne,u as e,q as ke,W as O,V as F,v as Fe,a2 as xe,Z as _,F as q,$ as Ve,X as $}from"./vue-CijE9XjK.js";import{v as $e}from"./index-zphzDQIO.js";import{o as G,at as Y,au as B,H as N,av as ee,a as j,K as te,aw as Ue,ax as U,I as le,ay as g,p as Le,C as Oe,ag as _e,az as he,aA as Ae,ah as a,aB as A,Q as Re}from"./index-EwodfUE9.js";import"./vuetify-DZHD7f6N.js";function R(d,i){let s=0;for(;s<d.length;)d[s]===i?d.splice(s,1):++s;return d}const Ke={key:0,class:"text-accent"},we={key:1,class:"text-accent"},z=M({__name:"FilterSelectMulti",props:K({title:{},items:{},filterType:{}},{include:{required:!0},includeModifiers:{},exclude:{required:!0},excludeModifiers:{}}),emits:K(["disable","toggleFilterType"],["update:include","update:exclude"]),setup(d){const i=d,s=w(d,"include"),C=w(d,"exclude"),{t:m}=G(),D=I(()=>s.value.length+C.value.length),p=Y(()=>i.items,(l,b)=>B.text.asc(l.title,b.title));function v(l){return s.value.includes(l)?g.INCLUDED:C.value.includes(l)?g.EXCLUDED:g.DISABLED}function x(l){switch(v(l)){case g.INCLUDED:return"mdi-plus-box";case g.EXCLUDED:return"mdi-minus-box";case g.DISABLED:default:return"mdi-checkbox-blank-outline"}}function y(l){switch(v(l)){case g.INCLUDED:return"text-green";case g.EXCLUDED:return"text-red";default:return}}function V(l){switch(v(l)){case g.INCLUDED:R(s.value,l),C.value.push(l);break;case g.EXCLUDED:R(C.value,l);break;case g.DISABLED:default:s.value.push(l)}}function k(l){R(s.value,l),R(C.value,l)}return(l,b)=>(u(),S(N,{class:"px-0 pb-3"},{default:o(()=>[c(ee,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:o(()=>[Z(L(l.title),1)]),_:1}),c(le,{"model-value":[...s.value,...C.value],items:e(p),placeholder:e(m)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{prepend:o(()=>[c(Ue,{location:"right",text:e(m)(l.filterType===e(U).CONJUNCTIVE?"constants.filter_type.conjunctive":"constants.filter_type.disjunctive")},{activator:o(({props:n})=>[c(j,Fe(n,{icon:l.filterType===e(U).CONJUNCTIVE?"mdi-set-center":"mdi-set-all",onClick:b[0]||(b[0]=T=>l.$emit("toggleFilterType"))}),null,16,["icon"])]),_:1},8,["text"])]),"prepend-item":o(()=>[c(N,{title:e(m)("common.disable"),onClick:b[1]||(b[1]=n=>l.$emit("disable"))},null,8,["title"]),c(te)]),selection:o(({item:n,index:T})=>[T===0&&D.value===1?(u(),O("span",Ke,L(n.title),1)):T===0?(u(),O("span",we,L(e(m)("navbar.side.filters.activeFilter",D.value)),1)):F("",!0)]),item:o(({item:n})=>[Ne((u(),S(N,{"data-custom-context-menu":"",title:n.title,class:ke(y(n.value)),onClick:T=>V(n.value),onContextmenu:T=>k(n.value)},{prepend:o(()=>[c(j,{icon:x(n.value)},null,8,["icon"])]),_:2},1032,["title","class","onClick","onContextmenu"])),[[e($e),()=>k(n.value)]])]),_:1},8,["model-value","items","placeholder"])]),_:1}))}}),Me={key:0,class:"text-accent"},Ge={key:1,class:"text-accent"},Q=M({__name:"FilterSelectSingle",props:K({title:{},items:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:K(["disable"],["update:modelValue"]),setup(d){const i=d,s=w(d,"modelValue"),C=Y(()=>i.items,(D,p)=>B.text.asc(D.title,p.title)),{t:m}=G();return(D,p)=>(u(),S(N,{class:"px-0 pb-3"},{default:o(()=>[c(ee,{class:"px-0 text-uppercase ml-1 font-weight-light text-subtitle-2"},{default:o(()=>[Z(L(D.title),1)]),_:1}),c(le,{modelValue:s.value,"onUpdate:modelValue":p[1]||(p[1]=v=>s.value=v),items:e(C),placeholder:e(m)("navbar.side.filters.disabled"),"bg-color":"secondary",class:"text-accent pt-1",density:"compact","hide-details":"",multiple:"",variant:"solo"},{"prepend-item":o(()=>[c(N,{title:e(m)("common.disable"),onClick:p[0]||(p[0]=v=>D.$emit("disable"))},null,8,["title"]),xe(D.$slots,"prepend-item"),c(te)]),selection:o(({item:v,index:x})=>[x===0&&s.value.length===1?(u(),O("span",Me,L(v.title),1)):x===0?(u(),O("span",Ge,L(e(m)("navbar.side.filters.activeFilter",s.value.length)),1)):F("",!0)]),_:3},8,["modelValue","items","placeholder"])]),_:3}))}}),He=M({__name:"Filters",setup(d){const{t:i,getTorrentStateString:s}=G(),{categories:C,torrentsByCategory:m}=_(Le()),{tags:D,torrentsByTag:p}=_(Oe()),{torrents:v,torrentsByStatus:x,statusFilter:y,categoryFilter:V,tagFilterInclude:k,tagFilterExclude:l,tagFilterType:b,torrentsByTracker:n,trackerFilterInclude:T,trackerFilterExclude:h,trackerFilterType:W}=_(_e()),{hostnameTrackers:ae}=_(he()),{filters:se,showFilterState:ie,showFilterCategory:ne,showFilterTag:re,showFilterTracker:oe}=_(Ae()),ue=I(()=>Object.values(a).filter(t=>typeof t=="number").map(t=>({title:`${s(t)} (${x.value[t]??0})`,value:t})).sort((t,r)=>B.text.asc(t.title,r.title))),ce=I(()=>[{title:`${i("navbar.side.filters.category.empty")} (${m.value[""]??0})`,value:""},...C.value.map(t=>({title:`${t.name} (${m.value[t.name]??0})`,value:t.name}))]),de=I(()=>[{title:`${i("navbar.side.filters.tag.empty")} (${p.value[""]??0})`,value:null},...D.value.map(t=>({title:`${t} (${p.value[t]??0})`,value:t}))]),ve=I(()=>[{title:`${i("navbar.side.filters.tracker.empty")} (${n.value[A.UNTRACKED]??0})`,value:A.UNTRACKED},{title:`${i("navbar.side.filters.tracker.not_working")} (${n.value[A.NOT_WORKING]??0})`,value:A.NOT_WORKING},...ae.value.map(t=>({title:`${t} (${n.value[t]??0})`,value:t}))]);function J(t){switch(t.value){case U.CONJUNCTIVE:t.value=U.DISJUNCTIVE;break;case U.DISJUNCTIVE:t.value=U.CONJUNCTIVE;break}}function me(){J(b)}function pe(){J(W)}const P=[a.UPLOADING,a.CHECKING_DISK,a.UL_FORCED,a.DOWNLOADING,a.META_DOWNLOAD,a.FORCED_META_DOWNLOAD,a.CHECKING_DISK,a.DL_FORCED,a.CHECKING_RESUME_DATA,a.MOVING],H=[a.ERROR,a.MISSING_FILES,a.UNKNOWN],X=[a.ERROR,a.MISSING_FILES,a.UNKNOWN,a.MOVING,a.DL_STOPPED,a.DL_STALLED,a.UL_STOPPED,a.CHECKING_DISK,a.CHECKING_RESUME_DATA];function fe(){y.value=[]}const ge=I(()=>v.value.filter(t=>P.includes(t.state)).length);function Ce(){y.value=P}const De=I(()=>v.value.filter(t=>H.includes(t.state)).length);function Te(){y.value=H}const ye=I(()=>v.value.filter(t=>X.includes(t.state)).length);function be(){y.value=X}function Ee(){V.value=[]}function Ie(){k.value=[],l.value=[]}function Se(){T.value=[],h.value=[]}return(t,r)=>e(ie)||e(ne)||e(re)||e(oe)?(u(),S(Re,{key:0,class:"pb-0 inherit-fg"},{default:o(()=>[(u(!0),O(q,null,Ve(e(se),E=>(u(),O(q,{key:E.name},[E.name==="state"&&E.active?(u(),S(Q,{key:0,modelValue:e(y),"onUpdate:modelValue":r[0]||(r[0]=f=>$(y)?y.value=f:null),title:e(i)("navbar.side.filters.state.title"),items:ue.value,onDisable:fe},{"prepend-item":o(()=>[c(N,{title:`${e(i)("navbar.side.filters.state.active")} (${ge.value})`,onClick:Ce},null,8,["title"]),c(N,{title:`${e(i)("navbar.side.filters.state.error")} (${De.value})`,onClick:Te},null,8,["title"]),c(N,{title:`${e(i)("navbar.side.filters.state.offline")} (${ye.value})`,onClick:be},null,8,["title"])]),_:1},8,["modelValue","title","items"])):F("",!0),E.name==="category"&&E.active?(u(),S(Q,{key:1,modelValue:e(V),"onUpdate:modelValue":r[1]||(r[1]=f=>$(V)?V.value=f:null),title:e(i)("navbar.side.filters.category.title"),items:ce.value,onDisable:Ee},null,8,["modelValue","title","items"])):F("",!0),E.name==="tag"&&E.active?(u(),S(z,{key:2,include:e(k),"onUpdate:include":r[2]||(r[2]=f=>$(k)?k.value=f:null),exclude:e(l),"onUpdate:exclude":r[3]||(r[3]=f=>$(l)?l.value=f:null),title:e(i)("navbar.side.filters.tag.title"),items:de.value,"filter-type":e(b),onDisable:Ie,onToggleFilterType:me},null,8,["include","exclude","title","items","filter-type"])):F("",!0),E.name==="tracker"&&E.active?(u(),S(z,{key:3,include:e(T),"onUpdate:include":r[4]||(r[4]=f=>$(T)?T.value=f:null),exclude:e(h),"onUpdate:exclude":r[5]||(r[5]=f=>$(h)?h.value=f:null),title:e(i)("navbar.side.filters.tracker.title"),items:ve.value,"filter-type":e(W),onDisable:Se,onToggleFilterType:pe},null,8,["include","exclude","title","items","filter-type"])):F("",!0)],64))),128))]),_:1})):F("",!0)}});export{He as default};
